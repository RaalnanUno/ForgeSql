{"version":3,"sources":["../../main/index.ts","../../main/db/sqlserver.ts","../../main/db/queries.ts"],"sourcesContent":["// File: electron/main/index.ts\r\nimport util from \"util\";\r\nimport { app, BrowserWindow, ipcMain } from \"electron\";\r\nimport path from \"path\";\r\n\r\nimport type { SqlServerConnectionProfile } from \"../shared/types\";\r\nimport { openDb, closeDb, queryText, buildOdbcConnectionString, query } from \"./db/sqlserver\";\r\nimport { listDatabasesSql, listTablesSql, listViewsSql, describeTableSql, primaryKeySql } from \"./db/queries\";\r\n\r\nlet win: BrowserWindow | null = null;\r\n\r\nfunction formatError(e: any): string {\r\n  if (!e) return \"Unknown error (empty).\";\r\n  if (typeof e === \"string\") return e;\r\n\r\n  const msg = e?.message ? String(e.message) : \"\";\r\n  if (msg && msg !== \"[object Object]\") return msg;\r\n\r\n  const nestedMsg =\r\n    e?.originalError?.message ??\r\n    e?.cause?.message ??\r\n    e?.innerError?.message ??\r\n    e?.error?.message;\r\n\r\n  if (nestedMsg) return String(nestedMsg);\r\n\r\n  const bits = [\r\n    e.code ? `code=${e.code}` : null,\r\n    e.number ? `number=${e.number}` : null,\r\n    e.state ? `state=${e.state}` : null,\r\n    e.class ? `class=${e.class}` : null,\r\n    e.serverName ? `server=${e.serverName}` : null,\r\n    e.sqlstate ? `sqlstate=${e.sqlstate}` : null,\r\n  ].filter(Boolean);\r\n\r\n  try {\r\n    const dump = JSON.stringify(e, Object.getOwnPropertyNames(e), 2);\r\n    return bits.length ? `${bits.join(\", \")}\\n${dump}` : dump;\r\n  } catch {\r\n    return bits.length ? bits.join(\", \") : String(e);\r\n  }\r\n}\r\n\r\nfunction splitFullName(fullName: string): { schema: string; table: string } {\r\n  const raw = (fullName ?? \"\").trim();\r\n  const parts = raw.split(\".\");\r\n  if (parts.length === 2) return { schema: parts[0], table: parts[1] };\r\n  return { schema: \"dbo\", table: raw };\r\n}\r\n\r\n// conservative identifier validation: dbo, TableName, ColumnName, etc.\r\nfunction isSafeIdent(s: string): boolean {\r\n  return /^[A-Za-z_][A-Za-z0-9_]*$/.test((s ?? \"\").trim());\r\n}\r\n\r\nfunction qIdent(name: string): string {\r\n  const n = (name ?? \"\").trim();\r\n  if (!isSafeIdent(n)) throw new Error(`Unsafe identifier: ${name}`);\r\n  // bracket quoting for SQL Server (safe for reserved words too)\r\n  return `[${n}]`;\r\n}\r\n\r\nfunction qFullName(fullName: string): { schema: string; table: string; sql: string } {\r\n  const { schema, table } = splitFullName(fullName);\r\n  if (!isSafeIdent(schema) || !isSafeIdent(table)) throw new Error(`Unsafe table name: ${fullName}`);\r\n  return { schema, table, sql: `${qIdent(schema)}.${qIdent(table)}` };\r\n}\r\n\r\nasync function createWindow() {\r\n  win = new BrowserWindow({\r\n    width: 1200,\r\n    height: 800,\r\n    webPreferences: {\r\n      preload: path.join(__dirname, \"../preload/index.js\"),\r\n      contextIsolation: true,\r\n      nodeIntegration: false,\r\n    },\r\n  });\r\n\r\n  const devUrl = process.env.VITE_DEV_SERVER_URL;\r\n  if (devUrl) await win.loadURL(devUrl);\r\n  else await win.loadFile(path.join(__dirname, \"../../../reactui/dist/index.html\"));\r\n}\r\n\r\napp.whenReady().then(createWindow);\r\n\r\napp.on(\"window-all-closed\", async () => {\r\n  await closeDb();\r\n  if (process.platform !== \"darwin\") app.quit();\r\n});\r\n\r\nipcMain.handle(\"db:open\", async (_evt, args: { profile: SqlServerConnectionProfile }) => {\r\n  try {\r\n    await openDb(args.profile);\r\n\r\n    const used =\r\n      (args.profile.connectionString ?? \"\").trim() ||\r\n      buildOdbcConnectionString(args.profile).connectionString;\r\n\r\n    return { ok: true, connectionString: used };\r\n  } catch (e: any) {\r\n    console.error(\"db:open failed raw:\", e);\r\n    console.error(\"db:open failed inspect:\", util.inspect(e, { depth: 10, colors: false, showHidden: true }));\r\n    if (e?.originalError) console.error(\"db:open originalError inspect:\", util.inspect(e.originalError, { depth: 10, colors: false, showHidden: true }));\r\n    if (e?.cause) console.error(\"db:open cause inspect:\", util.inspect(e.cause, { depth: 10, colors: false, showHidden: true }));\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:close\", async () => {\r\n  try {\r\n    await closeDb();\r\n    return { ok: true };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:listDatabases\", async () => {\r\n  try {\r\n    const r = await queryText(listDatabasesSql);\r\n    const databases = r.rows.map((x) => String(x[0]));\r\n    return { ok: true, databases };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:listTables\", async () => {\r\n  try {\r\n    const r = await queryText(listTablesSql);\r\n    const tables = r.rows.map((x) => String(x[0]));\r\n    return { ok: true, tables };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:listViews\", async () => {\r\n  try {\r\n    const r = await queryText(listViewsSql);\r\n    const views = r.rows.map((x) => String(x[0]));\r\n    return { ok: true, views };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:query\", async (_evt, args: { sql: string }) => {\r\n  try {\r\n    const r = await queryText(args.sql);\r\n    return { ok: true, result: { columns: r.columns, rows: r.rows }, rowCount: r.rowCount };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:describeTable\", async (_evt, args: { fullName: string }) => {\r\n  try {\r\n    const { schema, table } = splitFullName(args.fullName);\r\n    if (!isSafeIdent(schema) || !isSafeIdent(table)) throw new Error(`Unsafe table name: ${args.fullName}`);\r\n\r\n    const r = await query(describeTableSql(schema, table), { schema, table });\r\n\r\n    const cols = (r.recordset ?? []).map((x: any) => ({\r\n      name: String(x.name),\r\n      dataType: String(x.dataType),\r\n      isNullable: !!x.isNullable,\r\n      maxLength: x.maxLength === null || x.maxLength === undefined ? null : Number(x.maxLength),\r\n      numericPrecision: x.numericPrecision === null || x.numericPrecision === undefined ? null : Number(x.numericPrecision),\r\n      numericScale: x.numericScale === null || x.numericScale === undefined ? null : Number(x.numericScale),\r\n      isIdentity: !!x.isIdentity,\r\n    }));\r\n\r\n    return { ok: true, columns: cols };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:getPrimaryKey\", async (_evt, args: { fullName: string }) => {\r\n  try {\r\n    const { schema, table } = splitFullName(args.fullName);\r\n    if (!isSafeIdent(schema) || !isSafeIdent(table)) throw new Error(`Unsafe table name: ${args.fullName}`);\r\n\r\n    const r = await query(primaryKeySql(schema, table), { schema, table });\r\n    const pk = (r.recordset ?? []).map((x: any) => String(x.name));\r\n    return { ok: true, primaryKey: pk };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:updateCell\", async (_evt, args: { req: any }) => {\r\n  try {\r\n    const req = args.req as {\r\n      fullName: string;\r\n      pk: Record<string, any>;\r\n      column: string;\r\n      value: any;\r\n    };\r\n\r\n    const { sql: tableSql } = qFullName(req.fullName);\r\n\r\n    if (!req.pk || !Object.keys(req.pk).length) {\r\n      return { ok: false, error: \"Missing primary key values.\" };\r\n    }\r\n\r\n    if (!isSafeIdent(req.column)) return { ok: false, error: `Unsafe column: ${req.column}` };\r\n\r\n    const pkKeys = Object.keys(req.pk);\r\n    for (const k of pkKeys) {\r\n      if (!isSafeIdent(k)) return { ok: false, error: `Unsafe PK column: ${k}` };\r\n    }\r\n\r\n    const setSql = `${qIdent(req.column)} = @val`;\r\n    const whereSql = pkKeys.map((k) => `${qIdent(k)} = @pk_${k}`).join(\" AND \");\r\n    const sqlText = `UPDATE ${tableSql} SET ${setSql} WHERE ${whereSql};`;\r\n\r\n    const params: Record<string, any> = { val: req.value };\r\n    for (const k of pkKeys) params[`pk_${k}`] = req.pk[k];\r\n\r\n    const r = await query(sqlText, params);\r\n    return { ok: true, rowCount: r.rowCount };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n\r\nipcMain.handle(\"db:insertRow\", async (_evt, args: { req: any }) => {\r\n  try {\r\n    const req = args.req as {\r\n      fullName: string;\r\n      values: Record<string, any>;\r\n    };\r\n\r\n    const { schema, table, sql: tableSql } = qFullName(req.fullName);\r\n\r\n    const values = req.values ?? {};\r\n    const keys = Object.keys(values);\r\n    if (!keys.length) return { ok: false, error: \"No values provided.\" };\r\n\r\n    // exclude identity columns\r\n    const meta = await query(describeTableSql(schema, table), { schema, table });\r\n    const cols = (meta.recordset ?? []).map((x: any) => ({\r\n      name: String(x.name),\r\n      isIdentity: !!x.isIdentity,\r\n    }));\r\n    const colMap = new Map(cols.map((c) => [c.name.toLowerCase(), c]));\r\n\r\n    const safeKeys: string[] = [];\r\n    for (const k of keys) {\r\n      if (!isSafeIdent(k)) return { ok: false, error: `Unsafe column: ${k}` };\r\n      const c = colMap.get(k.toLowerCase());\r\n      if (!c) return { ok: false, error: `Unknown column: ${k}` };\r\n      if (c.isIdentity) continue;\r\n      safeKeys.push(k);\r\n    }\r\n\r\n    if (!safeKeys.length) return { ok: false, error: \"All provided fields were identity or invalid.\" };\r\n\r\n    const colSql = safeKeys.map(qIdent).join(\", \");\r\n    const valSql = safeKeys.map((k) => `@v_${k}`).join(\", \");\r\n    const sqlText = `INSERT INTO ${tableSql} (${colSql}) VALUES (${valSql});`;\r\n\r\n    const params: Record<string, any> = {};\r\n    for (const k of safeKeys) params[`v_${k}`] = values[k];\r\n\r\n    const r = await query(sqlText, params);\r\n    return { ok: true, rowCount: r.rowCount };\r\n  } catch (e: any) {\r\n    return { ok: false, error: formatError(e) };\r\n  }\r\n});\r\n","// File: electron/main/db/sqlserver.ts\r\nimport sql from \"mssql/msnodesqlv8\";\r\nimport { SqlServerConnectionProfile } from \"../../shared/types\";\r\n\r\nlet pool: sql.ConnectionPool | null = null;\r\n\r\nfunction normalizeServer(raw: string): string {\r\n  const s = (raw ?? \"\").trim();\r\n  if (!s) return \".\";\r\n\r\n  const lower = s.toLowerCase();\r\n  if (s === \".\" || lower === \"localhost\" || lower === \"(local)\") return \".\";\r\n\r\n  return s;\r\n}\r\n\r\nexport function buildOdbcConnectionString(profile: SqlServerConnectionProfile): {\r\n  driver: string;\r\n  connectionString: string;\r\n} {\r\n  const rawServer = (profile.server ?? \".\").trim();\r\n  const server = normalizeServer(rawServer);\r\n  const database = profile.database ?? \"master\";\r\n\r\n  const driver = \"ODBC Driver 17 for SQL Server\";\r\n\r\n  const encrypt = profile.encrypt ?? false;\r\n  const trustServerCertificate = profile.trustServerCertificate ?? true;\r\n\r\n  const parts: string[] = [];\r\n  parts.push(`Driver={${driver}}`);\r\n  parts.push(`Server=${server}`);\r\n  parts.push(`Database=${database}`);\r\n\r\n  if (profile.auth.kind === \"windows\") {\r\n    parts.push(\"Trusted_Connection=Yes\");\r\n  } else {\r\n    parts.push(`Uid=${profile.auth.user}`);\r\n    parts.push(`Pwd=${profile.auth.password}`);\r\n  }\r\n\r\n  parts.push(`Encrypt=${encrypt ? \"Yes\" : \"No\"}`);\r\n  parts.push(`TrustServerCertificate=${trustServerCertificate ? \"Yes\" : \"No\"}`);\r\n\r\n  return { driver, connectionString: parts.join(\";\") + \";\" };\r\n}\r\n\r\nfunction buildConfig(profile: SqlServerConnectionProfile): sql.config {\r\n  const raw = (profile.connectionString ?? \"\").trim();\r\n  if (raw) {\r\n    return {\r\n      driver: \"ODBC Driver 17 for SQL Server\",\r\n      connectionString: raw.endsWith(\";\") ? raw : raw + \";\",\r\n      options: {\r\n        trustedConnection: profile.auth.kind === \"windows\",\r\n      },\r\n    } as any;\r\n  }\r\n\r\n  const built = buildOdbcConnectionString(profile);\r\n  return {\r\n    driver: built.driver,\r\n    connectionString: built.connectionString,\r\n    options: {\r\n      trustedConnection: profile.auth.kind === \"windows\",\r\n    },\r\n  } as any;\r\n}\r\n\r\nexport async function openDb(profile: SqlServerConnectionProfile) {\r\n  await closeDb();\r\n  const cfg = buildConfig(profile);\r\n\r\n  console.log(\"[db] connecting with cfg:\", {\r\n    driver: (cfg as any).driver,\r\n    connectionString: (cfg as any).connectionString ? \"***\" : \"\",\r\n  });\r\n\r\n  pool = await new sql.ConnectionPool(cfg).connect();\r\n}\r\n\r\nexport async function closeDb() {\r\n  if (!pool) return;\r\n  try {\r\n    await pool.close();\r\n  } finally {\r\n    pool = null;\r\n  }\r\n}\r\n\r\nexport async function query(sqlText: string, params?: Record<string, any>) {\r\n  if (!pool) throw new Error(\"No open connection.\");\r\n  const req = pool.request();\r\n\r\n  if (params) {\r\n    for (const [k, v] of Object.entries(params)) {\r\n      req.input(k, v as any);\r\n    }\r\n  }\r\n\r\n  const resp = await req.query(sqlText);\r\n\r\n  const recordset = resp.recordset ?? [];\r\n  const columns = recordset.length ? Object.keys(recordset[0]) : [];\r\n  const rows = recordset.map((r: any) => columns.map((c) => r[c]));\r\n\r\n  return { columns, rows, rowCount: resp.rowsAffected?.[0] ?? 0, recordset };\r\n}\r\n\r\nexport async function queryText(sqlText: string) {\r\n  if (!pool) throw new Error(\"No open connection.\");\r\n  const resp = await pool.request().query(sqlText);\r\n\r\n  const recordset = resp.recordset ?? [];\r\n  const columns = recordset.length ? Object.keys(recordset[0]) : [];\r\n  const rows = recordset.map((r: any) => columns.map((c) => r[c]));\r\n\r\n  return { columns, rows, rowCount: resp.rowsAffected?.[0] ?? 0 };\r\n}\r\n","// File: electron/main/db/queries.ts\r\n\r\nexport function describeTableSql(_schema: string, _table: string) {\r\n  return `\r\nSELECT\r\n  c.COLUMN_NAME AS [name],\r\n  c.DATA_TYPE AS [dataType],\r\n  CASE WHEN c.IS_NULLABLE = 'YES' THEN 1 ELSE 0 END AS [isNullable],\r\n  CASE WHEN c.CHARACTER_MAXIMUM_LENGTH IS NULL THEN NULL ELSE c.CHARACTER_MAXIMUM_LENGTH END AS [maxLength],\r\n  CASE WHEN c.NUMERIC_PRECISION IS NULL THEN NULL ELSE c.NUMERIC_PRECISION END AS [numericPrecision],\r\n  CASE WHEN c.NUMERIC_SCALE IS NULL THEN NULL ELSE c.NUMERIC_SCALE END AS [numericScale],\r\n  CASE WHEN ic.column_id IS NULL THEN 0 ELSE 1 END AS [isIdentity]\r\nFROM INFORMATION_SCHEMA.COLUMNS c\r\nLEFT JOIN sys.tables t ON t.name = c.TABLE_NAME\r\nLEFT JOIN sys.schemas s ON s.schema_id = t.schema_id AND s.name = c.TABLE_SCHEMA\r\nLEFT JOIN sys.columns sc ON sc.object_id = t.object_id AND sc.name = c.COLUMN_NAME\r\nLEFT JOIN sys.identity_columns ic ON ic.object_id = t.object_id AND ic.column_id = sc.column_id\r\nWHERE c.TABLE_SCHEMA = @schema AND c.TABLE_NAME = @table\r\nORDER BY c.ORDINAL_POSITION;\r\n`.trim();\r\n}\r\n\r\nexport function primaryKeySql(_schema: string, _table: string) {\r\n  return `\r\nSELECT kcu.COLUMN_NAME AS [name]\r\nFROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc\r\nJOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE kcu\r\n  ON tc.CONSTRAINT_NAME = kcu.CONSTRAINT_NAME\r\n  AND tc.TABLE_SCHEMA = kcu.TABLE_SCHEMA\r\n  AND tc.TABLE_NAME = kcu.TABLE_NAME\r\nWHERE tc.CONSTRAINT_TYPE = 'PRIMARY KEY'\r\n  AND tc.TABLE_SCHEMA = @schema\r\n  AND tc.TABLE_NAME = @table\r\nORDER BY kcu.ORDINAL_POSITION;\r\n`.trim();\r\n}\r\n\r\nexport const listDatabasesSql = `\r\nSELECT name\r\nFROM sys.databases\r\nWHERE database_id > 4\r\nORDER BY name;\r\n`;\r\n\r\nexport const listTablesSql = `\r\nSELECT s.name + '.' + t.name AS [name]\r\nFROM sys.tables t\r\nJOIN sys.schemas s ON t.schema_id = s.schema_id\r\nORDER BY s.name, t.name;\r\n`;\r\n\r\nexport const listViewsSql = `\r\nSELECT s.name + '.' + v.name AS [name]\r\nFROM sys.views v\r\nJOIN sys.schemas s ON v.schema_id = s.schema_id\r\nORDER BY s.name, v.name;\r\n`;\r\n\r\nexport function selectTopSql(fullName: string, top = 100) {\r\n  return `SELECT TOP (${top}) * FROM ${fullName};`;\r\n}"],"mappings":"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","names":["sql","path","util"]}